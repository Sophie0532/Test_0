Sub RecuentoTablasATHENA_HIST()
    Dim pathHIST As String: pathHIST = "C:\DATOS\ATHENA_TASKMANAGER\db\ATHENA_NET_DATA_HIST.db"
    Dim tablas As Variant
    Dim resultado As Variant
    Dim i As Integer
    Dim resumen As String

    tablas = Array("DUTY", "DUTY_EVENT", "PRE_TASK", "DUTY_PLANNED_EXECUTED", "TOKEN_HISTORY")
    resumen = "Recuento de registros en ATHENA_HIST:" & vbNewLine

    For i = 0 To UBound(tablas)
        On Error Resume Next
        resultado = DB_DQL(pathHIST, "SELECT COUNT(*) FROM " & tablas(i), False)
        If Err.Number <> 0 Then
            resumen = resumen & tablas(i) & ": ERROR (" & Err.Description & ")" & vbNewLine
            Err.Clear
        ElseIf Not IsEmpty(resultado) Then
            resumen = resumen & tablas(i) & ": " & resultado(0)(0) & " registros" & vbNewLine
        Else
            resumen = resumen & tablas(i) & ": VAC√çA o no accesible" & vbNewLine
        End If
    Next i

    MsgBox resumen, vbInformation, "Resumen ATHENA_HIST"
End Sub
